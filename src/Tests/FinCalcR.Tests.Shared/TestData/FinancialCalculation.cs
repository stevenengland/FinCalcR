using Xunit;

namespace FinCalcR.Tests.Shared.TestData
{
    public static class FinancialCalculation
    {
        public static TheoryData<double, double, double, double, double, double> KnWanted =>
            new TheoryData<double, double, double, double, double, double>
            {
                { 12, 10, 9.5689685146845171, 0, 10, 1998.63856714 }, // With zero start
                { 12, 10.123, 4, 150000, -750, 112636.9953862361 }, // With decimal as years
                { 12, 10, 4, 150000, -750, 113187.5488186329 }, // From manual
                { 12, 25, 2.471803524, -1000, 0, -1853.9440984093485 }, // From manual / Book p.19
                { 12, 25, 5.841060678, 0, -100, -67628.896204469813 }, // Book p. 16
                { 12, 10, 4.121255148, 100000, -510.10, 75301.50 }, // Book p. 22
                { 12, 35, 5.3660387, 0, -550, -678177.09 }, // Book p. 30
                { 12, 18, 3.928487739, 0, -184, -57655.85 }, // Book p. 57
                { 12, 1, -22.10816415, -10000, -184, -9997.45 }, // Book p. 58
                { 12, 17, 7.720836132, -9997.45, -184, -114205.70 }, // Book p. 59
                { 12, 2, 1.981897562, 0, -2000, -48922.81 }, // Book p. 62
                { 12, 45, 6.784974465, -48922.81, -282.67, -2027489.70 }, // Book p. 64
                { 12, 45, 6.266827589, 0, -600, -1798658.87 }, // Book p. 65 1
                { 12, 10, 6.266827589, 0, -600, -99764.53 }, // Book p. 65 2
                { 12, 35, 6.266827589, -87764.53, -600, -1691684.55 }, // Book p. 66
                { 12, 35, 6.266827589, 12000, 0, 106974.32 }, // Book p. 67
                { 12, 10, 5.841060678, 170000, -1100, 125723.32 }, // Book p. 82
                { 12, 25, 3.928487739, -300, 0, -799.75 }, // Book p. 84 1
                { 12, 50, 3.928487739, -300, 0, -2132.01 }, // Book p. 84 2
                { 12, 26, 4.409771281, -0.7, 0, -2.20 }, // Book p. 97
                { 12, 15, 0.995445737, -2041, 0, -2369.54 }, // Book p. 115
                { 12, 15, 1.981897562, -2041, 0, -2746.92 }, // Book p. 116
                { 12, 25, 0, 0, -100, -30000 }, // Book p. 122
                { 12, 25, 0, 100, -100, -29900 }, // Same as Book p. 122 but with k0 > 0 -> The same result like from the calculator but it's a bug.
                { 12, 20, 3.928487739, 0, -150, -54576.26 }, // Book p. 125
                { 12, 45, 2.276104576, -2905, 0, -8082.57 }, // Book p. 128
                { 12, 45, 0.995445737, -1287, 0, -2013.91 }, // Book p. 129
                { 12, 18, 3.928487739, -10000, -184, -77914.01 }, // Book p. 142 1 // Error in the book -> expects 79914.01
                { 12, 18, 7.720836132, -10000, -184, -125640.18 }, // Book p. 142 2
                { 12, 17, 7.720836132, -10000, -184, -114215.13 }, // Book p. 143 1
                { 12, 1, -22.10816415, -114215.13, -184, -93369.56 }, // Book p. 143 2
            };

        public static TheoryData<double, double, double, double, double, double> K0Wanted =>
            new TheoryData<double, double, double, double, double, double>
            {
            { 12, 25, 2.471803524, 0, 1000, -539.39 }, // From manual // Book p. 19
            { 12, 25, 2.471803524, 100, 1000, -22900.85 }, // Non zero regular payment
            { 12, 25, 6.784974465, 0, 200000, -36849.84 }, // Book p. 18
            { 12, 35, 5.3660387, -550, 1000000, -49406.13 }, // Book p. 31
            { 12, 5, 3.445078463, 1000, 0, -55044.38 }, // Book p. 60
            { 12, 25, 5.841060678, -800, 0, 126059.52 }, // Book p. 80
            { 12, 25, 5.841060678, 1000, 0, -157574.40 }, // Book p. 81 -> Error in the book. Should be -1000 for the rate.
            { 12, 25, 5.841060678, -1000, 0, 157574.40 }, // Book p. 81 -> Error in the book. Should be -157574.40 for the start.
            { 12, 10, 1.981897562, 0, 100000, -82034.83 }, // Book p. 92
            { 12, 15, 2.256515397, 0, 2740, -1953.84 }, // Book p. 118
            { 12, 15, 2.256515397, 0, 2360, -1682.87 }, // Book p. 119
            { 12, 15, 2.256515397, 0, 2041, -1455.40 }, // Book p. 120
            { 12, 18, 2.667152753, 8083, 0, -1385363.36 }, // Book p. 130
            { 12, 18, 1.292317896, 2014, 0, -387946.76 }, // Book p. 131
            };

        public static TheoryData<bool, double, double, double, double, double, double> EWanted =>
            new TheoryData<bool, double, double, double, double, double, double>
            {
                { false, 12, 10, 9.568968515, 100, 1000, 6.30 },
                { false, 12, 25, 6.784974465, 0, 200000, 255.41 }, // From manual, book p. 17
                { true, 1, 25, 1.45461709, -250000, 0, -11827.95 }, // From manual, advance = true
                { false, 12, 1.5, 6.784974465, 1000, 0, 58.59 }, // From manual, book p. 24
                { false, 12, 50, 3.928487739, 0, 1000000, 536.09 }, // Book p. 26
                { false, 12, 40, 3.928487739, 0, 1000000, 861.28 }, // Book p. 27 1
                { false, 12, 30, 3.928487739, 0, 1000000, 1459.28 }, // Book p. 27 2
                { false, 12, 20, 3.928487739, 0, 1000000, 2748.45 }, // Book p. 28 1
                { false, 12, 10, 3.928487739, 0, 1000000, 6816.82 }, // Book p. 28 2
                { false, 12, 35, 5.3660387, 0, 1000000, 811.00 }, // Book p. 31
                { false, 12, 13, 3.445078463, 0, 55044.38, 280.21 }, // Book p. 61
                { false, 12, 45, 6.784974465, 0, 1000000, 282.67 }, // Book p. 63 1
                { false, 12, 45, 6.784974465, -48922.81, 1000000, -7.77 }, // Book p. 63 2
                { false, 12, 25, 5.841060678, 170000, 0, 1078.86 }, // Book p. 81
                { false, 12, 15, 7.720836132, 125723.32, 0, 1181.30 }, // Book p. 82
                { false, 12, 45, 2.959523727, 0, 997416, 884.35 }, // Book p. 133 1
                { false, 12, 45, 5.841060678, 0, 997416, 380.35 }, // Book p. 133 2
                { false, 12, 45, 8.64878798, 0, 997416, 151.89 }, // Book p. 133 1
            };

        public static TheoryData<double, double, double, double, double, double> NWanted =>
        new TheoryData<double, double, double, double, double, double>
        {
            { 12, 4, 150000, -750, 0, 27.51 }, // From manual
            { 12, 4.121255148, 100000, -510.10, 0, 27.19 }, // Book p. 23
            { 12, 5.3660387, -10000, -550, 1000000, 39.85 }, // Book p. 32
            { 12, 5.003639805, 250000, -1250, 0, 35.96 }, // Book p. 77
            { 12, 5.003639805, 200000, -1250, 0, 22.03 }, // Book p. 78
            { 12, 5.003639805, 150000, -1250, 0, 13.90 }, // Book p. 79
        };

        public static TheoryData<double, double, double, double, double, double> PWanted =>
        new TheoryData<double, double, double, double, double, double>
        {
            { 12, 14, -13.94, 0, 29.73, 5.559 }, // Book p. 20
            { 1, 25, -250000, 12000, 0, 1.455 }, // Book p. 21
            { 12, 3, 20000, -400, -7500, 4.597 }, // Book p. 25
            { 12, 35, 0, -550, 1000000, 7.271 }, // Book p. 30
            { 12, 0.83, 999, -107.9, 0, 17.532 }, // Book p. 72 -> Error in the book. Should be 18.516 but is 17.532
            { 12, 3, 30000, -850, 0, 1.297 }, // Book p. 73
            { 12, 4, 30000, -466, -15000, 8.289 }, // Book p. 74 1
            { 12, 5, 27500, -550, 0, 7.678 }, // Book p. 74 2
            { 12, 39, -0.1, 0, 0.7, 5.116 }, // Book p. 91
            { 12, 60, -3.58, 0, 17.98, 2.726 }, // Book p. 95
            { 12, 25, 0, -50, 30000, 5.169 }, // Book p. 123
            { 12, 20, 0, -150, 53600, 3.833 }, // Book p. 124
        };
    }
}
